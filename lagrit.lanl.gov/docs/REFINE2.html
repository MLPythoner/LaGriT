<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Jan Wills">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.06 (Macintosh; I; PPC) [Netscape]">
   <TITLE>REFINE1.html</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">
&nbsp;
<BLOCKQUOTE><B>Grid Refinement and&nbsp; Criteria - Algorithms</B>
<BLOCKQUOTE><FONT FACE="Times">The Refine command for the grid generation
code LaGriT uses various criteria to tag grid elements for refinement or
derefinement. When utilizing unstructured grids generated by LaGriT for
applications such as solution of partial differential equations (PDE) for
physical systems, it is desirable to modify the grid in order to optimize
it for the particular problem based on several principles. The goal is
to produce a better solution by creating better grid elements in various
regions of the domain of the PDE's. This can involve physical criteria
such as choosing smaller elements where physical variables are rapidly
changing or larger elements where the variables are relatively constant
in order not to waste computational effort. Grid elements can also be chosen
on various geometric criteria related to their shape such as different
formulations of an aspect ratio. In time dependent problems, it may be
necessary to refine and derefine the grid after each time step in order
to follow various changing phenomena such as moving concentration fronts,
shock waves, or advancing oxide layers. These factors make mesh refinement
crucial to the practical solution of physical modeling problems. We therefore
will detail several algorithms that are currently implemented for identifying
which grid elements should be refined or derefined based on geometric and
physical criteria. New algorithms will be added to this list and the current
ones modified as we obtain feed back from users.</FONT></BLOCKQUOTE>
</BLOCKQUOTE>
 
<BR>&nbsp;
<BLOCKQUOTE>&nbsp;&nbsp;&nbsp;&nbsp; I. Edges: Each edge is tested separately
to see if it should be tagged for refinement or derefinement.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Definition:
<P>&nbsp;&nbsp;&nbsp;&nbsp; c = a user supplied tolerance
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(i) = value of the field variable f at node
i
<P>&nbsp;&nbsp;&nbsp;&nbsp; l = length of the edge
<P>&nbsp;&nbsp;&nbsp;&nbsp; For the edge between nodes 1 and 2, we have
<P><IMG SRC="new_html/image5.jpg" HEIGHT=55 WIDTH=129>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp; Criteria:
<P>&nbsp;&nbsp;&nbsp;&nbsp; 1) Junction: Refine if the edge field values
straddle c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Tag for refinement if
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(1) > c and f(2) &lt; c
<P>&nbsp;&nbsp;&nbsp;&nbsp; or
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(1) &lt; c and f(2) > c
<P>&nbsp;&nbsp;&nbsp;&nbsp; example: For c = 0, refine if f changes sign
across the edge.
<P>&nbsp;&nbsp;&nbsp;&nbsp; 2) Constant: Refine if the edge&iacute;s field
values exceed c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Tag for refinement if
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(1) > c or f(2) > c
<P>&nbsp;&nbsp;&nbsp;&nbsp; 3) Maxsize: Refine if the edge length exceeds
c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Tag if l > c
<P>&nbsp;&nbsp;&nbsp;&nbsp; 4) Delta: Refine if the magnitude of the difference
of the field values at the edge ends exceeds c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Tag if&nbsp; | f(1) - f(2) | > c
<P>&nbsp;&nbsp;&nbsp;&nbsp; 5) Lambda Refine: Refine if lambda/dx &lt;
c. Where dx&nbsp; is a scale length (here taken to be the edge length)
<BR><IMG SRC="new_html/image9.jpg" HEIGHT=52 WIDTH=156></BLOCKQUOTE>
 
<BLOCKQUOTE>Generally lambda/dx is a quality measure of the discretization.
A larger value of usually indicates a better grid discretization.&nbsp;
There are some special cases.&nbsp; If&nbsp; one of the field values is
zero as could happen on a boundary, then lambda/dx 1/2.&nbsp; If f(1) is
equal to&nbsp; f(2) then lambda/dx&nbsp; is divergent but the algorithm
uses a&nbsp; small number e = .000001 added to the denominator lambda/dx
to give a large but finite value of lambda/dx thus indicating a good discretization.
<P>&nbsp;II. Faces: Each face is tested separately for refinement or derefinement.
For the tetrahedral face defined by nodes 1, 2, and 3, we have
<P><IMG SRC="new_html/image1.jpg" HEIGHT=111 WIDTH=154>
<BR>
&nbsp;
<P>&nbsp;&nbsp;&nbsp;&nbsp; where A is the area of the face.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Criteria:
<P>&nbsp;&nbsp;&nbsp;&nbsp; 1) Junction: Refine if any of the faces field
values straddle c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Tag for refinement if
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(1) > c and f(2), f(3) &lt; c
<P>&nbsp;&nbsp;&nbsp;&nbsp; or
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(2) > c and f(1), f(3) &lt; c
<P>&nbsp;&nbsp;&nbsp;&nbsp; or
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(3) > c and f(1), f(2) &lt; c
<P>&nbsp;&nbsp;&nbsp;&nbsp; or all of the above with > and &lt; interchanged.
<BLOCKQUOTE>example: For c = 0, refine if f changes sign between any of
the three nodes.</BLOCKQUOTE>
&nbsp;2) Constant:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Refine if any of the faces field values exceed c.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Tag for refinement if
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
f(1) > 2 or f(2) > c or f(3) > c.
<BLOCKQUOTE>&nbsp;</BLOCKQUOTE>
3)Maxsize:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Refine if the face area exceeds c.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Tag if A > c.
<BLOCKQUOTE>&nbsp;</BLOCKQUOTE>
4)Aspect Ratio: Refine if the faces aspect ratio is less than c. The aspect
ratio (AR) is defined as the ratio of the radius of the inscribed circle
of the&nbsp; triangular face to the radius of the circumscribed circle.
We renormalize this ratio of multiplying by 2 so that the ratio equals
one for an equilateral triangle.
<BR>&nbsp;
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>AR=&nbsp;&nbsp; 2 <U>RN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</U>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
where RIN = radius of inscribed circle
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ROUT
<BLOCKQUOTE>&nbsp;&nbsp; ROUT = radius of circumscribed circle</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
AR is never greater than one. Tag if AR &lt; c.&nbsp;&nbsp; Generally the
smaller AR is the more elongated the face is.</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
 
<BLOCKQUOTE>5) Lambda Refine: Refine if lamda &lt;c.&nbsp; Where lambda
is taken to be the radius of the circumscribed circle RC of the triangular
face
<BR>&nbsp;
<BR>&nbsp;
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>lambda = <U>f(xcen)</U>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
grad f</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
where xcen is the centroid of&nbsp; the triangular face, and we have assumed
a linear interpolation of f. grad fis evaluated on the face by a suitable
approximation involving a linear interpolation of f and&nbsp; the line
integral around the edge of the face.
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>&nbsp;</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>
 
<BLOCKQUOTE>&nbsp;&nbsp;&nbsp;&nbsp; III. Tets: Each tetrahedron is tested
separately for refinement or derefinement
<BR><IMG SRC="new_html/image4.jpg" HEIGHT=134 WIDTH=155>
<BR>
&nbsp;
<BR>&nbsp;
<P>&nbsp;&nbsp;&nbsp;&nbsp; where V is the volume of the tetrahedron.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Criteria:
<P>&nbsp;&nbsp;&nbsp;&nbsp; 1) Junction: Refine if any of the tets field
values straddle c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; example: For c = 0 refine if f changes sign
between any of the four nodes.
<P>&nbsp;&nbsp;&nbsp;&nbsp; 2) Constant: Refine if any of the tets field
values exceed c.
<BLOCKQUOTE>
<BLOCKQUOTE>&nbsp;Tag for refinement if
<BR>f(1) > c or f(2) > c or f(3) > c or f(4) > c</BLOCKQUOTE>
</BLOCKQUOTE>
&nbsp;&nbsp;&nbsp;&nbsp; 3) Maxsize: Refine if the tet volume exceeds c.
<BLOCKQUOTE>
<BLOCKQUOTE>Tag if V > c</BLOCKQUOTE>
</BLOCKQUOTE>
&nbsp;&nbsp;&nbsp;&nbsp; 4) Aspect Ratio: Refine if the tets aspect ratio
is less than c. For the tet the aspect ratio (AR) is defined as the ratio
of the radius of the inscribed sphere of the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; tet to the radius of the circumscribed sphere.
We renormalize this ratio by multiplying by three so that the ratio equals
one for a regular tetrahedron (composed
<BR>&nbsp;&nbsp;&nbsp;&nbsp; of equilateral triangular faces).
<BR>&nbsp;
<BLOCKQUOTE>AR = 3 RIN/ROUT&nbsp; where RIN radius of inscribed sphere
<BR>ROUT radius of circumscribed sphere
<BR>AR is never greater than one.</BLOCKQUOTE>
&nbsp;&nbsp;&nbsp;&nbsp; Tag if AR &lt; c.
<P>&nbsp;&nbsp;&nbsp;&nbsp; Generally the smaller AR is, the more elongated
the tet is.
<P>&nbsp;&nbsp;&nbsp;&nbsp; 6) Lambda Refine: Refine if lamda/dx >c . Where
lambda is taken to be the radius of the circumscribed sphere ROUT of the
tet.
<P>&nbsp;&nbsp;&nbsp;&nbsp; lambda = | f(xcen) | / grad f
<P>&nbsp;&nbsp;&nbsp;&nbsp; f(xcen) = (f(1) + f(2) + f(3) + f(4))/4
<P>&nbsp;&nbsp;&nbsp;&nbsp; where xcen is the centroid of the tet, and
we have assumed linear interpolations of f.&nbsp; grad f is evalutaed for
the tet by an approximation involving linear
<BR>&nbsp;&nbsp;&nbsp;&nbsp; interpolation au the surface integral&nbsp;
over the surface of the tet.
<BR>&nbsp;
<BR>&nbsp;
<P>&nbsp;&nbsp;&nbsp;&nbsp; IV. Face Edges: Same algorithms of the Faces
category except all edges of the face are tagged for refinement or derefinement
if the condition is met for the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; face.
<P>&nbsp;&nbsp;&nbsp;&nbsp; V. Tet Edges: Same algorithms of the tet category
except all edges of the tet are tagged for refinement or derefinement if
the condition is met for the tet.
<BR>&nbsp;</BLOCKQUOTE>
 
</BODY>
</HTML>
